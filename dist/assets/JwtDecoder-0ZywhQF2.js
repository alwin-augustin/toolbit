import{r as m,j as e,t as l,S as N}from"./vendor-react-BRDxYWww.js";import{u as v,B as s}from"./index-CSjyOe-k.js";import{T as i}from"./textarea-Bf7Irmiz.js";import{T as w}from"./ToolCard-DSYdX5rd.js";import"./vendor-misc-LEklij9m.js";import"./vendor-data-DBwwMht3.js";import"./vendor-ui-BA32w1ww.js";import"./vendor-routing-state-QrItU_Pd.js";import"./card-A36AAJPa.js";function W(){const[d,n]=m.useState(""),[a,c]=m.useState({header:"",payload:"",signature:"",valid:!1}),{toast:p}=v(),u=()=>{try{const t=d.split(".");if(t.length!==3)throw new Error("Invalid JWT format - must have 3 parts separated by dots");const[r,h,y]=t,j=JSON.parse(atob(r.replace(/-/g,"+").replace(/_/g,"/"))),f=JSON.parse(atob(h.replace(/-/g,"+").replace(/_/g,"/")));c({header:JSON.stringify(j,null,2),payload:JSON.stringify(f,null,2),signature:y,valid:!0})}catch(t){c({header:`Error: ${t instanceof Error?t.message:"Invalid JWT"}`,payload:"",signature:"",valid:!1})}},o=(t,r)=>{navigator.clipboard.writeText(t),p({description:`${r} copied to clipboard!`})},x=()=>{n("eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c")};return e.jsx(w,{title:"JWT Decoder",description:"Decode JSON Web Tokens (JWT) to view header, payload, and signature",icon:e.jsx(N,{className:"h-5 w-5"}),children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"jwt-input",className:"text-sm font-medium",children:"JWT Token"}),e.jsx(i,{id:"jwt-input",placeholder:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",value:d,onChange:t=>n(t.target.value),className:"h-20 font-mono text-sm","data-testid":"input-jwt"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s,{onClick:u,"data-testid":"button-decode",children:"Decode JWT"}),e.jsx(s,{onClick:x,variant:"outline","data-testid":"button-sample",children:"Load Sample"})]})]}),a.header&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Header"}),e.jsxs(s,{onClick:()=>o(a.header,"Header"),variant:"outline",size:"sm","data-testid":"button-copy-header",children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Copy"]})]}),e.jsx(i,{value:a.header,readOnly:!0,className:`h-32 font-mono text-sm ${a.valid?"":"text-destructive"}`,"data-testid":"output-header"})]}),a.payload&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Payload"}),e.jsxs(s,{onClick:()=>o(a.payload,"Payload"),variant:"outline",size:"sm","data-testid":"button-copy-payload",children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Copy"]})]}),e.jsx(i,{value:a.payload,readOnly:!0,className:"h-32 font-mono text-sm","data-testid":"output-payload"})]}),a.signature&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium",children:"Signature"}),e.jsxs(s,{onClick:()=>o(a.signature,"Signature"),variant:"outline",size:"sm","data-testid":"button-copy-signature",children:[e.jsx(l,{className:"h-4 w-4 mr-2"}),"Copy"]})]}),e.jsx(i,{value:a.signature,readOnly:!0,className:"h-16 font-mono text-sm","data-testid":"output-signature"})]})]})]})})}export{W as default};
